import{u as F,a as I,r as u,j as s,L as q,B as j,v as D}from"./index-BPNOnu4i.js";import{u as T,F as k}from"./index.esm-Bae_MGDG.js";import{Q as E,B as m}from"./ReactToastify-RTiFja8s.js";import{I as i}from"./Input-C4p4FEP5.js";function K(){const r=T(),v=F(),p=I(),[d,x]=u.useState([]),[o,h]=u.useState(""),[y,l]=u.useState(!1),N=e=>{e.key==="Enter"&&o.trim()&&(x(t=>[...t,o.trim()]),h(""),e.preventDefault())},C=e=>{x(t=>t.filter(n=>n!==e))},w=async e=>{var g;l(!0);const t=sessionStorage.getItem("userId")||"",n=sessionStorage.getItem("authToken")||"";let f=null;if(e!=null&&e.image[0]){const b=new FormData;b.append("image",e==null?void 0:e.image[0]);try{const a=await fetch("https://learning-platform-lake.vercel.app/v1/image/upload",{method:"POST",body:b}),c=await a.json();if(a.ok)f=(g=c==null?void 0:c.data)==null?void 0:g.secure_url;else throw new Error("Image upload failed")}catch{m.error("Failed to upload image"),l(!1);return}}const S={title:e==null?void 0:e.title,description:e==null?void 0:e.description,creator:t,price:e==null?void 0:e.price,tags:d,shortBio:e==null?void 0:e.shortBio,imageUrl:f},B=await v(D({courseData:S,headers:{Authorization:`Bearer ${n}`}}));l(!1),B.meta.requestStatus==="fulfilled"?(m.success("Course created successfully!"),setTimeout(()=>{p("/dashboard")},2e3)):m.error("Failed to create the course")};return s.jsxs("div",{className:"bg-[#f7f7f8] min-h-screen px-[60px]",children:[s.jsx(E,{}),y&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white bg-opacity-100 z-50",children:s.jsx(q,{})}),s.jsx("div",{className:"flex items-start justify-start pt-[42px] w-full",children:s.jsxs("div",{className:"bg-white rounded-md w-full mb-[60px]",children:[s.jsx("div",{className:"p-6",children:s.jsx("h2",{className:"text-[24px] leading-[33px] font-semibold text-[#191919]",children:"Basic Details"})}),s.jsx("div",{className:"p-[38px] border-t border-[#E4E4E7]",children:s.jsx(k,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(w),children:[s.jsx(i,{type:"text",placeholder:"Enter the course title",label:"Course Title",...r.register("title",{required:"Course title is required"}),className:"mb-6"}),s.jsx(i,{type:"text",placeholder:"Description of the course",label:"Course Description",...r.register("description",{required:"Course description is required"}),className:"mb-6"}),s.jsx(i,{type:"text",placeholder:"Short bio of the course",label:"Course Short Bio",...r.register("shortBio",{required:"Short Bio is required"}),className:"mb-6"}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-[16px] mb-[8px] font-medium text-[#191919]/70",children:"Course Tags"}),s.jsx("input",{type:"text",placeholder:"Press Enter to add a tag",value:o,onChange:e=>h(e.target.value),onKeyDown:N,className:"w-full px-5 py-5 border border-[#F1F1F3] rounded-[8px] placeholder:text-[#B3B3B3] font-normal leading-[21px] bg-[#FCFCFD] focus:outline-none"}),s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map((e,t)=>s.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-sm px-2 py-1 rounded-lg cursor-pointer",onClick:()=>C(e),children:[e," Ã—"]},t))})]}),s.jsx(i,{type:"number",placeholder:"Price",label:"Price",...r.register("price",{required:"Price is required"}),className:"mb-6"}),s.jsx(i,{type:"file",label:"Course Image",...r.register("image",{required:"Course image is required"}),className:"mb-6"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(j,{variant:"outlined",onClick:()=>p("/dashboard"),children:"Cancel"}),s.jsx(j,{type:"submit",children:"Save"})]})]})})})]})})]})}export{K as default};
